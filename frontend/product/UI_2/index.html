<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8">
  <title>Thêm sản phẩm</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
  <!-- Select2 -->
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">

  <style>
    .btn-admin {
      border-radius: .35rem
    }

    /* Ảnh: cố định 300px để nút khớp đúng chiều ngang */
    .product-image-box {
      width: 300px;
      /* cố định 300 */
      aspect-ratio: 1/1;
      border: 1px dashed #c9c9c9;
      border-radius: .5rem;
      background: #f8f9fa;
      display: grid;
      place-items: center;
      overflow: hidden
    }

    .product-image-box img {
      width: 100%;
      height: 100%;
      object-fit: cover
    }

    /* Nhóm nút chọn/xóa ảnh gọn và khớp 300px */
    .product-image-actions {
      width: 300px;
      /* khớp với .product-image-box */
      display: flex;
      gap: .5rem;
      align-items: center
    }

    .product-image-actions .btn {
      height: 38px;
      padding: .375rem .75rem
    }

    /* Biến input file thành vùng click của nút */
    .file-input {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer
    }

    .chip-input {
      display: flex;
      flex-wrap: wrap;
      gap: .35rem;
      min-height: 38px;
      padding: .35rem;
      border: 1px solid #ced4da;
      border-radius: .375rem;
      background: #fff
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: .35rem;
      padding: .25rem .5rem;
      border-radius: 999px;
      background: #e9f5ff;
      font-size: .875rem
    }

    .chip .remove {
      cursor: pointer
    }

    .form-text-compact {
      margin-top: .25rem;
      font-size: .8rem;
      color: #6c757d
    }

    .label-filter-admin-product {
      font-weight: 600
    }
  </style>
</head>

<body class="bg-light">

  <div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h4 class="mb-0">Thêm sản phẩm</h4>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        <form id="productCreateForm">
          <div class="row">
            <!-- LEFT 4 cols: Hình ảnh -->
            <div class="col-lg-4 mb-3">
              <label class="form-label label-filter-admin-product">Hình ảnh sản phẩm</label>
              <div class="product-image-box mb-2" id="previewBox">
                <span class="text-muted"><i class="fa-regular fa-image me-1"></i> 300×300</span>
              </div>

              <!-- Nút gọn, chiều ngang đúng 300px -->
              <div class="product-image-actions mb-1">
                <label class="btn btn-outline-primary w-100 position-relative m-0">
                  <i class="fa-solid fa-upload me-1"></i> Chọn ảnh
                  <input type="file" accept="image/*" id="productImageFile" class="file-input">
                </label>
                <button type="button" class="btn btn-outline-secondary" id="btnClearImage" aria-label="Xóa ảnh">
                  <i class="fa-solid fa-xmark"></i>
                </button>
              </div>
              <div class="form-text-compact">Ảnh hiển thị 300×300. Đây là preview giao diện.</div>
            </div>

            <!-- RIGHT 8 cols: Form fields -->
            <div class="col-lg-8">
              <div class="row g-3 mb-2">
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Tên sản phẩm</label>
                  <input type="text" class="form-control" placeholder="Nhập tên sản phẩm">
                </div>
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Slug</label>
                  <input type="text" class="form-control" placeholder="slug-tu-dong-hoac-nhap">
                </div>
              </div>

              <div class="row g-3 mb-2">
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Code</label>
                  <input type="text" class="form-control" placeholder="Mã nội bộ">
                </div>
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">ISBN</label>
                  <input type="text" class="form-control" placeholder="ISBN">
                </div>
              </div>

              <div class="row g-3 mb-2">
                <div class="col-12">
                  <label class="form-label label-filter-admin-product">Mô tả sản phẩm</label>
                  <textarea rows="4" class="form-control" placeholder="Mô tả chi tiết…"></textarea>
                </div>
              </div>

              <div class="row g-3 mb-2">
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Giá bán</label>
                  <div class="input-group">
                    <input type="number" min="0" step="1" class="form-control" placeholder="0">
                    <span class="input-group-text">₫</span>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Đơn vị tính</label>
                  <input type="text" class="form-control" placeholder="Quyển / Bộ / ...">
                </div>
              </div>

              <div class="row g-3 mb-2">
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Danh mục</label>
                  <div class="chip-input" id="chipCats">
                    <span class="text-muted">Chọn danh mục…</span>
                  </div>
                  <div class="form-text-compact">Preview chip. Khi làm thật có thể dùng Select2 multiple.</div>
                </div>
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Tác giả</label>
                  <div class="chip-input" id="chipAuthors">
                    <span class="text-muted">Chọn tác giả…</span>
                  </div>
                  <div class="form-text-compact">Preview chip. Khi làm thật có thể dùng Select2 multiple.</div>
                </div>
              </div>

              <div class="row g-3 mb-2">
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Nhà xuất bản</label>
                  <select class="form-select setupSelect2">
                    <option value="">-- Chọn NXB --</option>
                    <option>NXB A</option>
                    <option>NXB B</option>
                    <option>NXB C</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label class="form-label label-filter-admin-product">Trạng thái</label>
                  <select class="form-select setupSelect2">
                    <option value="">-- Chọn trạng thái --</option>
                    <option value="ACTIVE">Đang bán</option>
                    <option value="INACTIVE">Ẩn</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <hr class="my-3">
          <div class="d-flex justify-content-end gap-2">
            <button type="button" class="btn btn-outline-secondary" id="btnCancel">Hủy</button>
            <button type="button" class="btn btn-primary btn-admin" id="btnSaveDraftBottom">
              <i class="fa-solid fa-floppy-disk me-1"></i> Lưu nháp
            </button>
            <button type="submit" class="btn btn-success btn-admin">
              <i class="fa-solid fa-check me-1"></i> Lưu sản phẩm
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Bootstrap + deps -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Select2 -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.full.min.js"></script>

  <script>
    // Preview ảnh 300x300
    const fileInput = document.getElementById('productImageFile');
    const previewBox = document.getElementById('previewBox');
    const btnClear = document.getElementById('btnClearImage');

    function setPreview(file) {
      const reader = new FileReader();
      reader.onload = e => {
        previewBox.innerHTML = '<img alt="preview">';
        previewBox.querySelector('img').src = e.target.result;
      };
      reader.readAsDataURL(file);
    }
    fileInput?.addEventListener('change', e => {
      const f = e.target.files?.[0];
      if (f) { setPreview(f); }
    });
    btnClear?.addEventListener('click', () => {
      if (fileInput) { fileInput.value = ""; }
      previewBox.innerHTML = '<span class="text-muted"><i class="fa-regular fa-image me-1"></i> 300×300</span>';
    });

    // Select2 demo
    $(function () {
      $('.setupSelect2').each(function () { $(this).select2({ width: '100%' }); });
    });

    // Chips demo tĩnh
    function renderChips(el, items) {
      if (!el) { return; }
      el.innerHTML = '';
      items.forEach(t => {
        const s = document.createElement('span');
        s.className = 'chip';
        s.innerHTML = `<span>${t}</span><i class="fa-solid fa-xmark remove" aria-label="remove"></i>`;
        el.appendChild(s);
      });
    }
    renderChips(document.getElementById('chipCats'), ['Khoa học', 'Thiếu nhi']);
    renderChips(document.getElementById('chipAuthors'), ['Nguyễn A', 'Trần B']);

    // Nút điều hướng
    const btnCancel = document.getElementById('btnCancel');
    btnCancel?.addEventListener('click', () => history.back());

    // Lưu nháp demo
    const btnSaveDraftBottom = document.getElementById('btnSaveDraftBottom');
    function onSaveDraft() { alert('Lưu nháp: demo giao diện'); }
    btnSaveDraftBottom?.addEventListener('click', onSaveDraft);

    // Submit demo
    document.getElementById('productCreateForm')?.addEventListener('submit', function (e) {
      e.preventDefault();
      alert('Submit: demo giao diện');
    });
  </script>
</body>

</html>